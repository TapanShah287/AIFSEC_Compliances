<!doctype html>
<html lang="en">
<head>
{% load static %}
<link rel="icon" href="{% static 'img/favicon.ico' %}" sizes="any">
<link rel="icon" type="image/svg+xml" href="{% static 'img/favicon.svg' %}">
<link rel="apple-touch-icon" href="{% static 'img/apple-touch-icon.png' %}">
  <meta charset="utf-8">
  <meta name="csrf-token" content="{{ csrf_token }}">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}AIF Compliance Portal{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'primary': '#4f46e5',
            'secondary': '#64748b',
            'success': '#22c55e',
            'danger': '#ef4444',
            'light': '#f8fafc',
            'dark': '#1e293b',
          }
        }
      }
    }
  </script>
  {% block head %}{% endblock %}
</head>
<body class="bg-light text-dark">
  <div class="fixed top-0 left-0 h-full w-64 bg-dark text-white p-5">
    <h1 class="text-2xl font-bold mb-10">AIF Compliance</h1>
    <ul class="space-y-4 text-lg">
      <li><a href="{% url 'portal-home' %}" class="flex items-center hover:text-primary"><i class="bi bi-grid-1x2 mr-3"></i>Dashboard</a></li>
      <li><a href="{% url 'funds:portal-funds' %}" class="flex items-center hover:text-primary"><i class="bi bi-piggy-bank mr-3"></i>Funds</a></li>
      <li><a href="{% url 'portal-investors' %}" class="flex items-center hover:text-primary"><i class="bi bi-people mr-3"></i>Investors</a></li>
      <li><a href="{% url 'portal-companies' %}" class="flex items-center hover:text-primary"><i class="bi bi-building mr-3"></i>Companies</a></li>
      <li><a href="{% url 'portal-transactions' %}" class="flex items-center hover:text-primary"><i class="bi bi-arrow-left-right mr-3"></i>Transactions</a></li>
      <li><a href="{% url 'portal-compliance' %}" class="flex items-center hover:text-primary"><i class="bi bi-clipboard-check mr-3"></i>Compliance</a></li>
    </ul>
    <div class="absolute bottom-5 left-5 right-5 text-sm text-secondary">
      <div class="flex items-center justify-between">
        <span>{{ request.user.username }}</span>
        <a class="text-secondary hover:text-white" href="{% url 'logout' %}"><i class="bi bi-box-arrow-right"></i></a>
      </div>
    </div>
  </div>
  <main class="ml-64 p-8">
    {% block content %}{% endblock %}
  </main>
  <script>
    // Minimal helper for fetch JSON with CSRF
    function getCSRF(){
      const m = document.cookie.match(/csrftoken=([^;]+)/);
      return m ? m[1] : '';
    }
    async function api(url, method='GET', data=null){
      const opt = {method, headers:{'Accept':'application/json'}};
      if(data){
        opt.headers['Content-Type']='application/json';
        opt.headers['X-CSRFToken']=getCSRF();
        opt.body = JSON.stringify(data);
      }
      const r = await fetch(url, opt);
      if(!r.ok){ throw new Error(await r.text()); }
      return await r.json().catch(()=>({ok:true}));
    }
  </script>
  {% block scripts %}{% endblock %}
</body>
</html>
